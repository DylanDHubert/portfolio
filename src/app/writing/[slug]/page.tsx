import { notFound } from "next/navigation";
import { Meta, Schema, Column, Heading, Text, Tag } from "@once-ui-system/core";
import { baseURL, person } from "@/resources";
import { formatDate } from "@/utils/formatDate";

// WRITING PIECES DATA
const writingPieces = [
  {
    slug: "theia",
    title: "Theia",
    summary: "A haunting story about an aging painter whose obsession with perfection and deteriorating vision leads to a devastating conclusion.",
    publishedAt: "2025-03-22",
    readingTime: "12 min read",
    genre: "Literary Fiction",
    tags: ["Art", "Aging", "Perfection", "Vision", "Dark"],
    image: "/images/placeholder/theia.jpg",
    featured: true,
    content: `
March 22, 2025
Theia

Cecil, looking upon the familiar face of his wife, could not help but admire her beauty. She had a certain and specific presence about her. The way her dark hair curled— framing her nose and the glasses upon it. The imperceptible and nearly invisible hairs that softened her face. Her eyes. Green and bright. Peering intently upon her work. She cooked. The scents of garlic and of boiling butter curled about the room, an invisible partner to the smoke of his cigarette which danced in the air— curling and waving and warping. Each strand of her hair had a regal perfection. And her chin sharp and her cheeks high. Her smile bright. And as he gazed so intently upon her face, he could not help but notice the mole which sat upon her lip. It was a beauty mark. But he did not find it so beautiful. She was the perfect picture, though he could no longer help himself but feel that the mark upon her face was as a droplet of deep black paint. He never let his paint smudge. Not since he was young and inexperienced. He found that deep in his thoughts he did not error. He did not think. He simply saw. And he painted what he saw.

Cecil was old. His sons had grown and left. His daughters too. Within his mind, he dwelt upon them often. Most often, his youngest daughter, who he had named Mara. She was by now in her middle age and had sons and daughters of her own. He read about them in the letters that she sent to her mother. He wondered what they looked like. He wondered whether his granddaughters had also inherited Theia's mark. Mara had. He remembered the mark. But he could not picture her face. It existed in his memory, but as he would read her letters and attempt to make that face, the face of his final daughter, he found it always obscured behind a veil of opaque indifference.

"Dinner is ready, Cee." Theia turned across the room. The movement swept the hair across her face. She looked at her husband. He was still painting. Painting what he saw. And in his age and immobility, he saw the same scene each day. A beautiful woman. A kitchen and its furnishings. The way she moved back and forth. Tending for what she did. He was not done and she knew he would not come. Still, she caught his eye— "Do come before it gets cold, Cee."

He did not come quickly. Nor did he make her wait long. They had long since exhausted the words that may have filled the silence but, for politeness above all else, Theia inquired as to the state of his painting.

"Fine," he replied. It was always fine. He wished she would not ask.

Cecil finished his meal, and looking upon Theia's face, thanked her for dinner.

She smiled at him. And then she watched as he walked to his corner, picked up his brush, sat down, and began gazing intently upon her face. Theia knew this gaze well. She could picture his mind eye. The canvas in front of him. And on it, her, subtly smiling and gazing intently through the green eyes that were so perfectly captured upon that piece. Everything from the pans and the dripping grease to the flames of the stove and the smoke of his cigarette. Captured in a still. So perfect. So right. So real.

Cecil admired Theia's face upon his canvas. She was so beautiful, he thought. He stared at her picture and it was only when the oil lamp began to flicker that Cecil realized the time. Theia had long since gone to bed. It was normal. It was regular. It was their routine. And so in line with all else regular and normal, he finished his painting with a single drop of inky blackness, he placed it upon the stack of identical others, and then he went to lay next to his wife. He brushed her hair across her face— draping it to the side. And then he kissed her gently and closed his eyes to the peaceful darkness in which he found his perfect world.

The days continued as they always had. Theia cleaned and cooked and read letters from Mara and their other children. Cecil painted what he saw. And what he saw was Theia, cleaning and cooking and reading. The lamps burned softer. Theia's green eyes, once so piercing, blurred at their edges. He did not mind. He did not want to mind. His paintings were crisp and perfect. As Cecil worked he would find himself lost deep within thought. He thought about his children. And theirs. Their youth. The sorrows and pains that marred their letters and the joys and elations which so often brought Theia to tears of happiness.

When he was young he would walk the city streets. He would walk for hours and ages. Into and through new neighborhoods with new people and new places. He would find a park or a bench. He would light a cigarette and find a local boy— whom he would give a handful of change saying "You, young man, bring me a cold beer and you may keep the remainder." And then he would paint what he saw. Tall buildings of old stone. Trees of great age and wisdom. The blur of the passers–by.

But now this had passed too, and it also became a blur of unknown strangers and unknown times that smeared across his mind's eye. He could not picture these places. But he could remember them. Sometimes he would dig through his paintings and easels and catch a glimpse of these places— places which he had painted with the care and correctness of a photograph. And though he so greatly desired to see the scene, which he had so expertly laid upon the canvas, he never did. Only ever catching a glimpse between the strokes of a brush that had long since fulfilled its purpose. And now these paintings fulfilled their small purpose. Proof of what he had once seen with his eyes. Proof of the pictures they painted before him. Proof of the imperfections that could only be rectified by his capturings.

"Cee?" he heard. He had lost himself in thought. "Cecil!"

"Yes, my love?"

She ran her hand through her hair and it fell across her face, veiling her features in an obscured blackness. He wondered what was beneath.

"Dinner, Cecil. It's getting cold."

"Ah," he said, though not aloud, "I'll be there in a moment."

And he was there in a moment. The food was still warm. He gazed across the table at Theia. "You've been quiet as of late, my love," she said. "Are you well?"

"Fine, Theia. I'm fine."

They proceeded to eat in silence with only the faint tearing of her envelope and the wisps of his burning cigarette to accompany the stale air.

Cecil, like each other night, returned to his work. Only when he felt he had gazed long enough upon Theia's face did he pick up his brush— dipping it into the angry darkness that always sat upon his palette and then finally staining the canvas with its deep black. He did not look at his finished work before he put it on top of his stack. He washed his brushes and with his palette clean he closed his eyes, drifting into his perfect darkness.

In these years Cecil had grown quiet. He would barely speak— only nodding yes, no, maybe, later, tomorrow, never. He painted as he always did. Theia and her beautiful face. Her cooking. The pans and the pots and dishes and greases and smells. He would think, then he would dip his brush into the most absolutely appropriate color, and he would piece by piece paint his scene. The shadows that danced behind the cabinets. The darkness below the glow of the oven. The blackness of the hair that masked her face and seemed to smother her breath.

She would speak to him often. But he mostly did not hear. When she spoke he saw silence. Her mouth had grown increasingly concerned. He wondered why but cared not to listen. Theia was not only beautiful but smart. She had been incomparably successful in her lifetime. She wondered to herself whether he was losing his hearing. She thought not. She worried that he was instead losing himself. He had not realized it yet, but she suspected his vision was fading. And with it would fade his only window into the world. For him, this window faced not only outwards, but inwards. And so with its loss, she feared that he would lose far more than the prints that the world left upon his mind.

Time went on like this. Cecil painted. His stack grew taller. The paintings, so accurate as to be photographs, continued. He went on in his silence. He moved within his darkness. Ever yearning for the completion of his visions. But the more he looked the less he saw. And the more time passed the less he had. His memory was sharp. He could recall any day, or every day (as they were all the same), with absolute precision. But still, Cecil could not see that which he desired. His daughter's face. The perfection which he used to see upon the brow of Theia. He yearned for darkness. For sleep. For the brightness of the dreams between the deathly dark of his waking moments.

One day, he listened to Theia with utter attention. She told him that she worried deeply. That she could not understand. That Mara and his other children, having heard her concerns, had grown worried too. He told her he loved her. He gazed, out of the corner of his eye, upon the mole on her face. It seemed bigger. He told her he was okay and he painted. And when she finally left for the store, he stood and felt his way to the kitchen. The stone tile was cold on his feet. He tried one last time. Tried to see Theia, to see Mara, to see the city streets he once knew. Nothing came. Not blurred, not faded—just nothing. He closed his eyes. And for the first time, it made no difference at all. He felt for a spoon. Its metal too was cold. He looked at it intently. Its reflections shown softly in his peripheral. He raised it to his face and pressed the coldness of its hard steel to his lid. He felt no pain. Only the warmth of blood rushing down his face. He again razed his spoon. Pressing it firmly against his other lid. And pushing with the deep satisfaction of permanent darkness.

Nobody could understand. They would cry to Theia. Who would also cry. She loved Cecil. She loved her children and theirs which hugged against her side. She felt the cold of rain falling alongside the warmth of her saline tears. Cecil left little apart from his family. His paintings were his life. And as Cecil's children and grandchildren dug through his work, what they saw confused them— a series of paintings, dated on the back, always of Theia in her kitchen. The blackness upon her face grew. Day by day. Week by week. Year by year. Larger and larger. Until the paintings most recent, that lacked all but darkness.
    `,
  },
  {
    slug: "the-last-cafe-on-earth",
    title: "The Last Café on Earth",
    summary: "A short story about a barista who serves coffee to the last remaining humans in a post-apocalyptic world.",
    publishedAt: "2025-01-15",
    readingTime: "8 min read",
    genre: "Science Fiction",
    tags: ["Post-Apocalyptic", "Human Connection", "Coffee"],
    image: "/images/placeholder/cafe-story.jpg",
    featured: true,
    content: "Coming soon...",
  },
  {
    slug: "letters-to-my-future-self",
    title: "Letters to My Future Self",
    summary: "A collection of personal reflections on growth, change, and the passage of time.",
    publishedAt: "2025-01-10",
    readingTime: "5 min read",
    genre: "Personal Essay",
    tags: ["Reflection", "Growth", "Time"],
    image: "/images/placeholder/letters.jpg",
    featured: false,
    content: "Coming soon...",
  },
  {
    slug: "the-art-of-stillness",
    title: "The Art of Stillness",
    summary: "How I learned to find peace in the chaos of modern life through Taoist philosophy and daily practice.",
    publishedAt: "2024-12-20",
    readingTime: "6 min read",
    genre: "Philosophy",
    tags: ["Taoism", "Mindfulness", "Peace"],
    image: "/images/placeholder/stillness.jpg",
    featured: false,
    content: "Coming soon...",
  },
];

interface PageProps {
  params: {
    slug: string;
  };
}

export async function generateMetadata({ params }: PageProps) {
  const resolvedParams = await params;
  const piece = writingPieces.find(p => p.slug === resolvedParams.slug);
  
  if (!piece) {
    return {
      title: "Writing Not Found",
    };
  }

  return Meta.generate({
    title: `${piece.title} – ${person.name}`,
    description: piece.summary,
    baseURL: baseURL,
    image: `/api/og/generate?title=${encodeURIComponent(piece.title)}`,
    path: `/writing/${piece.slug}`,
  });
}

export default async function WritingPiece({ params }: PageProps) {
  const resolvedParams = await params;
  const piece = writingPieces.find(p => p.slug === resolvedParams.slug);

  if (!piece) {
    notFound();
  }

  return (
    <Column maxWidth="m" gap="xl">
      <Schema
        as="article"
        baseURL={baseURL}
        title={piece.title}
        description={piece.summary}
        path={`/writing/${piece.slug}`}
        image={`/api/og/generate?title=${encodeURIComponent(piece.title)}`}
        author={{
          name: person.name,
          url: `${baseURL}/about`,
          image: `${baseURL}${person.avatar}`,
        }}
      />

      {/* HEADER */}
      <Column gap="16">
        <Heading variant="display-strong-l">
          {piece.title}
        </Heading>
        
        <div style={{ display: 'flex', gap: '12px', alignItems: 'center', flexWrap: 'wrap' }}>
          <Text variant="label-default-s" onBackground="neutral-weak">
            {formatDate(piece.publishedAt, false)}
          </Text>
          <Text variant="label-default-s" onBackground="neutral-weak">
            {piece.readingTime}
          </Text>
          <Tag label={piece.genre} variant="neutral" />
        </div>

        <Text variant="body-default-l" onBackground="neutral-weak">
          {piece.summary}
        </Text>

        <div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap' }}>
          {piece.tags.map((tag, index) => (
            <Tag key={index} label={tag} variant="neutral" />
          ))}
        </div>
      </Column>

      {/* CONTENT */}
      <div 
        style={{
          lineHeight: '1.8',
          fontSize: '18px',
          color: 'var(--color-on-background)',
        }}
        dangerouslySetInnerHTML={{ __html: piece.content.replace(/\n\n/g, '<br><br>') }}
      />
    </Column>
  );
} 